apiVersion: v1
kind: page
spec:
  id: cn1tds0
  title: Page 1
  content:
    - component: Text
      name: text2
      layout:
        columnSize: 1
      props:
        variant: h1
        value: RUN yarn test:rest:start
    - component: Text
      name: typography
      layout:
        columnSize: 1
      props:
        value:
          $$jsExpression: |
            `query1: ${query1.data.args.query1_param1}`
    - component: Button
      name: button
      layout:
        columnSize: 1
      props:
        content: fetch query2
        onClick:
          $$jsExpressionAction: "query2.fetch({value: 'query2_value' })"
    - component: Text
      name: typography1
      layout:
        columnSize: 1
      props:
        value:
          $$jsExpression: |
            `query2: ${query2.data?.json.value}`
    - component: Text
      name: text
      layout:
        columnSize: 1
      props:
        value:
          $$jsExpression: |
            queryWithTransform.data
    - component: Text
      name: text1
      layout:
        columnSize: 1
      props:
        value:
          $$jsExpression: |
            `query4 authorization: ${queryWithEnv?.data.headers.Authorization}`
  queries:
    - name: query1
      query:
        kind: rest
        url: http://localhost:8080/get
        searchParams:
          - name: query1_param1
            value:
              $$jsExpression: |
                parameters.param1
        headers: []
        method: GET
      parameters:
        - name: param1
          value:
            $$jsExpression: |
              "query1_value"
    - name: query2
      mode: mutation
      query:
        kind: rest
        url: http://localhost:8080/post
        headers: []
        body:
          kind: raw
          content:
            $$jsExpression: |
              JSON.stringify(parameters)
          contentType: application/json
        method: POST
        searchParams: []
      parameters:
        - name: value
          value: incorrect
    - name: queryWithTransform
      query:
        kind: rest
        url: http://localhost:8080/get
        searchParams: []
        headers: []
        method: GET
        transform: 'return `query3: Transformed ${data?.url}`'
        transformEnabled: true
    - name: queryWithEnv
      query:
        kind: rest
        headers:
          - name: Authorization
            value:
              $$env: TEST_VAR
        method: GET
        searchParams: []
        url: http://localhost:8080/get
